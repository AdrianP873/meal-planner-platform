version: 0.2

env:
  variables:
    SAM_BUCKET: adriaplu-prod-bucket
phases:
  install:
    runtime-versions:
      python: 3.7
    commands:
      - echo "Installing linting and styling packages"
      - pip install isort flake8 pylint
  build:
    commands:
      - isort src/api/*.py
      - flake8 src/api/
      - echo "Running tests..."
      - echo "TBC"
  post_build:
    commands:
      - echo "Packaging SAM template"
      - sam package --template-file ./infra/template.yaml --s3-bucket $SAM_BUCKET --output-template-file packaged-template.yaml
artifacts:
  files:
    - packaged-template.yaml
  name: PackagedSource
